import{_ as B,r as o,a as D,o as U,u as P,b as _,c as v,e as f,w as m,d as l,F as R,g as S,t as h}from"./index-5e3051ec.js";import{P as E,L as F}from"./index-22813159.js";import{S as I}from"./index-0f76cfe5.js";import{l as N}from"./index-035c2cfb.js";import{s as k}from"./http-c830e3c3.js";import"./use-expose-52ad8c3a.js";import"./use-tab-status-233d5ab8.js";const M={class:"topic-list"},$=["src","onClick"],j={class:"title van-ellipsis"},q={class:"subtitle van-ellipsis"},z={class:"price van-ellipsis"},A={__name:"TopicView",setup(G){let i=o(1);const r=o(0),n=D({topicList:[]}),p=o(!1),c=o(!1),u=o(!1),d=async(e,s=1)=>{i.value=s;const a=await N(i);a.data&&a.data.length?(e(a),r.value=a.total):k({message:"获取数据失败",wordBreak:"break-word"})},g=o(0),L=o(),w=()=>{let e=new Date().getTime();console.log(e),e-g.value<=300&&(console.log(1111),L.value.scrollIntoView({behavior:"smooth",block:"start"})),g.value=e};U(()=>{d(e=>{n.topicList=e.data,r.value=e.total})});const b=async()=>{d(e=>{n.topicList=e.data,k("刷新成功"),p.value=!1,u.value=!0})},y=()=>{i.value<r.value?d(e=>{n.topicList.push(...e.data),c.value=!1},i.value+1):(c.value=!1,u.value=!0)},V=P(),T=e=>{V.push({name:"TopicDetail",params:{id:e}})};return(e,s)=>{const a=I,x=F,C=E;return _(),v("div",{class:"topic-container",ref_key:"topicContainer",ref:L},[f(a,null,{default:m(()=>[l("div",{class:"head",onClick:w},"专题")]),_:1}),f(C,{modelValue:p.value,"onUpdate:modelValue":s[1]||(s[1]=t=>p.value=t),onRefresh:b},{default:m(()=>[f(x,{loading:c.value,"onUpdate:loading":s[0]||(s[0]=t=>c.value=t),finished:u.value,"finished-text":"没有更多了",onLoad:y,"immediate-check":!1},{default:m(()=>[l("div",M,[(_(!0),v(R,null,S(n.topicList,t=>(_(),v("div",{class:"topic-item",key:t.id},[l("img",{src:t.scene_pic_url,alt:"",onClick:H=>T(t.id)},null,8,$),l("div",j,h(t.title),1),l("div",q,h(t.subtitle),1),l("div",z,h(t.price_info)+"元起",1)]))),128))])]),_:1},8,["loading","finished"])]),_:1},8,["modelValue"])],512)}}},Z=B(A,[["__scopeId","data-v-3b96910b"]]);export{Z as default};
