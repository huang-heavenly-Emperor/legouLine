import{A as oe,B as ce,a7 as ue,M as N,L as de,E as ne,a8 as re,Q as _e,e as c,H as Q,a9 as me,I as le,K as ie,U as V,D as L,r as w,O as D,P as Z,aa as ve,R as H,S as fe,ab as q,ac as K,ad as ee,ae as te,af as se,Y as ge,ag as be,J as j,ah as he,ai as pe,aj as Se,q as we,_ as ye,x as Pe,u as Ie,a as xe,l as Be,y as Ce,b as P,c as B,d as s,w as M,t as I,F as W,g as Y,h as ke,n as Te,p as Ve,k as Le}from"./index-5e3051ec.js";import{S as Me}from"./index-0f76cfe5.js";import{n as Ne}from"./navBar-2ff5468b.js";import{_ as De}from"./productListComponent-1e31a7fe.js";import{i as Ae,P as Ee,a as ae}from"./http-c830e3c3.js";import{s as Re}from"./index-ca0b7413.js";import{a as Fe}from"./index-9c2d18c1.js";import{a as $e}from"./index-56caebaf.js";import{A as Oe,a as ze,b as Ge}from"./index-6b6d28e5.js";import{S as Ue,a as He}from"./index-7bb8ccc7.js";import"./index-9a6c82b8.js";/* empty css                                                             */import"./use-expose-52ad8c3a.js";const[qe,J]=oe("action-bar-icon"),Ke=ce({},ue,{dot:Boolean,text:String,icon:String,color:String,badge:N,iconClass:de,badgeProps:Object,iconPrefix:String});var je=ne({name:qe,props:Ke,setup(e,{slots:u}){const v=re();_e(Oe);const f=()=>{const{dot:_,badge:y,icon:n,color:p,iconClass:d,badgeProps:g,iconPrefix:a}=e;return u.icon?c(me,Q({dot:_,class:J("icon"),content:y},g),{default:u.icon}):c(le,{tag:"div",dot:_,name:n,badge:y,color:p,class:[J("icon"),d],badgeProps:g,classPrefix:a},null)};return()=>c("div",{role:"button",class:J(),tabindex:0,onClick:v},[f(),u.default?u.default():e.text])}});const We=ie(je),[Ye,O]=oe("stepper"),Je=200,z=(e,u)=>String(e)===String(u),Qe={min:V(1),max:V(1/0),name:V(""),step:V(1),theme:String,integer:Boolean,disabled:Boolean,showPlus:L,showMinus:L,showInput:L,longPress:L,autoFixed:L,allowEmpty:Boolean,modelValue:N,inputWidth:N,buttonSize:N,placeholder:String,disablePlus:Boolean,disableMinus:Boolean,disableInput:Boolean,beforeChange:Function,defaultValue:V(1),decimalLength:N};var Xe=ne({name:Ye,props:Qe,emits:["plus","blur","minus","focus","change","overlimit","update:modelValue"],setup(e,{emit:u}){const v=(t,i=!0)=>{const{min:r,max:l,allowEmpty:b,decimalLength:$}=e;return b&&t===""||(t=te(String(t),!e.integer),t=t===""?0:+t,t=Number.isNaN(t)?+r:t,t=i?Math.max(Math.min(+l,t),+r):t,se($)&&(t=t.toFixed(+$))),t},f=()=>{var t;const i=(t=e.modelValue)!=null?t:e.defaultValue,r=v(i);return z(r,e.modelValue)||u("update:modelValue",r),r};let _;const y=w(),n=w(f()),p=D(()=>e.disabled||e.disableMinus||+n.value<=+e.min),d=D(()=>e.disabled||e.disablePlus||+n.value>=+e.max),g=D(()=>({width:Z(e.inputWidth),height:Z(e.buttonSize)})),a=D(()=>ve(e.buttonSize)),A=()=>{const t=v(n.value);z(t,n.value)||(n.value=t)},E=t=>{e.beforeChange?he(e.beforeChange,{args:[t],done(){n.value=t}}):n.value=t},C=()=>{if(_==="plus"&&d.value||_==="minus"&&p.value){u("overlimit",_);return}const t=_==="minus"?-e.step:+e.step,i=v(pe(+n.value,t));E(i),u(_)},G=t=>{const i=t.target,{value:r}=i,{decimalLength:l}=e;let b=te(String(r),!e.integer);if(se(l)&&b.includes(".")){const X=b.split(".");b=`${X[0]}.${X[1].slice(0,+l)}`}e.beforeChange?i.value=String(n.value):z(r,b)||(i.value=b);const $=b===String(+b);E($?+b:b)},R=t=>{var i;e.disableInput?(i=y.value)==null||i.blur():u("focus",t)},m=t=>{const i=t.target,r=v(i.value,e.autoFixed);i.value=String(r),n.value=r,ge(()=>{u("blur",t),be()})};let o,S;const x=()=>{S=setTimeout(()=>{C(),x()},Je)},k=()=>{e.longPress&&(o=!1,clearTimeout(S),S=setTimeout(()=>{o=!0,C(),x()},Se))},T=t=>{e.longPress&&(clearTimeout(S),o&&j(t))},U=t=>{e.disableInput&&j(t)},F=t=>({onClick:i=>{j(i),_=t,C()},onTouchstartPassive:()=>{_=t,k()},onTouchend:T,onTouchcancel:T});return H(()=>[e.max,e.min,e.integer,e.decimalLength],A),H(()=>e.modelValue,t=>{z(t,n.value)||(n.value=v(t))}),H(n,t=>{u("update:modelValue",t),u("change",t,{name:e.name})}),fe(()=>e.modelValue),()=>c("div",{role:"group",class:O([e.theme])},[q(c("button",Q({type:"button",style:a.value,class:[O("minus",{disabled:p.value}),{[ee]:!p.value}],"aria-disabled":p.value||void 0},F("minus")),null),[[K,e.showMinus]]),q(c("input",{ref:y,type:e.integer?"tel":"text",role:"spinbutton",class:O("input"),value:n.value,style:g.value,disabled:e.disabled,readonly:e.disableInput,inputmode:e.integer?"numeric":"decimal",placeholder:e.placeholder,"aria-valuemax":e.max,"aria-valuemin":e.min,"aria-valuenow":n.value,onBlur:m,onInput:G,onFocus:R,onMousedown:U},null),[[K,e.showInput]]),q(c("button",Q({type:"button",style:a.value,class:[O("plus",{disabled:d.value}),{[ee]:!d.value}],"aria-disabled":d.value||void 0},F("plus")),null),[[K,e.showPlus]])])}});const Ze=ie(Xe);const et=we();function tt(e){return Ae({url:"/bufan/goods/detailaction",data:{id:e,openId:et.openId}})}const h=e=>(Ve("data-v-9bdbf13b"),e=e(),Le(),e),st={class:"goodsDetail-container"},at={class:"nav-bar"},ot={class:"banner"},nt=["src"],lt=h(()=>s("div",{class:"tip"},[s("div",{class:"info"},"30天无忧退货"),s("div",{class:"info"},"48小时快速退款"),s("div",{class:"info"},"满88元免邮费")],-1)),it={class:"goodsInfo-card"},ct={class:"title"},ut={class:"desc"},dt={class:"price"},rt=h(()=>s("div",{class:"divider"},null,-1)),_t=h(()=>s("div",{class:"left"},"请选择规格数量",-1)),mt={class:"goods-config"},vt=h(()=>s("div",{class:"title"}," 商品参数 ",-1)),ft={class:"left"},gt=["value"],bt=["innerHTML"],ht={class:"issue"},pt=h(()=>s("div",{class:"title"},"常见问题",-1)),St={class:"issue-list"},wt={class:"title"},yt={class:"content"},Pt={class:"like"},It=h(()=>s("div",{class:"title"}," 大家都在看 ",-1)),xt={class:"list"},Bt={class:"card"},Ct={class:"left"},kt=["src"],Tt={class:"right"},Vt={class:"temp"},Lt=h(()=>s("div",{class:"title"},"价格：",-1)),Mt={class:"price"},Nt={class:"temp"},Dt=h(()=>s("div",{class:"title"},"数量：",-1)),At=h(()=>s("br",null,null,-1)),Et={class:"count"},Rt=h(()=>s("br",null,null,-1)),Ft=h(()=>s("br",null,null,-1)),$t={__name:"GoodsDetail",setup(e){const u=w(!1),v=w(!1);let f=w(0);const _=Pe(),y=Ie(),n=w(1),p=D(()=>n.value*a.info.retail_price),d=w(!1),g=w(""),a=xe({allnumber:0,attribute:[],brand:[],collected:!1,comment:{},gallery:[],info:{},issue:[],productList:[]});Be(()=>{g.value=_.params.id,A(g.value)}),Ce(()=>{g.value=_.params.id,A(g.value)});const A=async m=>{let o=await tt(m);a.allnumber=o.allnumber,a.attribute=o.attribute,a.brand=o.brand,a.collected=o.collected,a.comment=o.comment,a.gallery=o.gallery,a.info=o.info,a.issue=o.issue,a.productList=o.productList,console.log(o)},E=async()=>{let m=await Fe(g.value);a.collected=!a.collected,console.log(m),ae(a.collected?"收藏成功":"取消收藏成功",{duration:500})},C=()=>{d.value=!d.value,f.value=1},G=()=>{f.value=0},R=async m=>{if(f.value++,f.value===1)d.value=!0;else if(f.value===2){m==="cart"?u.value=!0:v.value=!0;let o={number:n.value,goodsId:g.value,allPrise:p.value},S=m==="cart"?$e:Re,x=m==="cart"?"添加购物车成功":"提交订单成功",k=m==="cart"?"添加购物车失败":"提交订单失败";(await S(o)).data?(ae({message:x,wordBreak:"break-word",forbidClick:!0,duration:500}),setTimeout(()=>{d.value=!1,f.value=0,m==="buy"&&y.push({name:"Order"})},500)):showNotify({type:"warning",message:k}),setTimeout(()=>{u.value=!1,v.value=!1},500)}else d.value=!1,f.value=0};return(m,o)=>{const S=Me,x=He,k=Ue,T=le,U=Ze,F=Ee,t=We,i=Ge,r=ze;return P(),B("div",st,[s("div",at,[c(S,null,{default:M(()=>[c(Ne,{title:"产品详情"})]),_:1}),s("div",ot,[c(k,{class:"banner-list",autoplay:3e3,"lazy-render":"","show-indicators":!1},{default:M(()=>[(P(!0),B(W,null,Y(a.gallery,l=>(P(),ke(x,{key:l.id,class:"item"},{default:M(()=>[s("img",{src:l.img_url,class:"big-img"},null,8,nt)]),_:2},1024))),128))]),_:1})]),lt,s("div",it,[s("div",ct,I(a.info.name),1),s("div",ut,I(a.info.goods_brief),1),s("div",dt,"￥"+I(a.info.retail_price),1),rt,s("div",{class:"select",onClick:C},[_t,c(T,{name:"arrow",class:"right"})])]),s("div",mt,[vt,(P(!0),B(W,null,Y(a.attribute,l=>(P(),B("div",{class:"temp",key:l.name+l.value},[s("div",ft,I(l.name),1),s("input",{type:"text",value:l.value,class:"right"},null,8,gt)]))),128))]),s("div",{class:"goods-detail-confi",innerHTML:a.info.goods_desc},null,8,bt),s("div",ht,[pt,s("div",St,[(P(!0),B(W,null,Y(a.issue,l=>(P(),B("div",{class:"item",key:l.id},[s("div",wt,I(l.question),1),s("div",yt,I(l.answer),1)]))),128))])]),s("div",Pt,[It,s("div",xt,[c(De,{"search-product-list":a.productList},null,8,["search-product-list"])])])]),c(F,{show:d.value,"onUpdate:show":o[1]||(o[1]=l=>d.value=l),round:"",position:"bottom",class:"popup-config",style:{height:"30%"},onClose:G},{default:M(()=>[s("div",Bt,[s("div",Ct,[s("img",{src:a.info.primary_pic_url,alt:""},null,8,kt)]),s("div",Tt,[s("div",Vt,[Lt,s("div",Mt,"￥"+I(a.info.retail_price),1)]),s("div",Nt,[Dt,At,s("div",Et,[Rt,Ft,c(U,{modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=l=>n.value=l),integer:""},null,8,["modelValue"])])])])])]),_:1},8,["show"]),c(r,{class:"buy-action"},{default:M(()=>[c(t,{icon:"star",class:Te(["collect",{active:a.collected}]),onClick:E,color:a.collected?"#cea62a":"#333"},null,8,["color","class"]),c(t,{icon:"cart-o",class:"cart",badge:a.allnumber},null,8,["badge"]),c(i,{class:"add",type:"warning",text:"加入购物车",onClick:o[2]||(o[2]=l=>R("cart")),loading:u.value},null,8,["loading"]),c(i,{class:"nowBuy",type:"danger",text:"立即购买",onClick:o[3]||(o[3]=l=>R("buy")),loading:v.value},null,8,["loading"])]),_:1})])}}},Zt=ye($t,[["__scopeId","data-v-9bdbf13b"]]);export{Zt as default};
